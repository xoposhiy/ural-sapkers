= Общие сведения об игре =

ИГРА — классический Bomberman [http://en.wikipedia.org/wiki/Bomberman]
== Цель игры ==
1. Побеждает тот, кто набрал больше очков.

2. Очки дают за уничтожение объектов. За стены - по 10 очков, За уничтожение других игроков - по 1000 очков (судя по-всему, это практически гарантирует выигрыш). За суицид снимают 1000 очков.

3. Игра заканчивается судя по всему тогда, когда умирает один из игроков.


== Протокол общения игроков с сервером ==
1. Клиент и сервер посылают друг другу сообщения в строго определенном формате (см. [SapkaProtocol]). Каждое сообщение/команда завершается символом ';'.

2. Игра проходит в реальном (или почти реальном) времени. То есть никакой очередности в посылке сообщений нет - сервер живет по своим часам и независимо от действий клиента отправляет ему информацию о происходящих событиях.

3. Игра состоит из нескольких раундов (количество раундов задается в настройках карты в файле map.properties). Раунды нумеруются с 1. Первый раунд начинается командой сервера game-info: {{{PID<номер игрока>&<map-info>}}} (Игроки нумеруются с 0). Последующие раунды начинаются командой start-round-info: {{{START<номер раунда>&<map-info>}}}.

4. Раунд заканчивается командой finish-round-info: {{{REND<пробел><очки>}}}. Последний раунд и игра заканчиваются командой finish-game-info: {{{GEND<пробел><rank-score-info>}}}.

5. По ходу игры сервер оповещает игроков о происходящем на поле при помощи команды map-change-info: {{{T<время>&<sapkas-part>&<changes-part>[&<danger-part>]}}}. Number after 'T' defines the internal server time (in ticks). One tick is about 50 milliseconds. (см. файл interesting/clock.txt)


== Игровое поле ==
1. Игра протекает на квадратном поле, начальное состояние которого задается в файле из каталога maps, на который указывает настройка server.properties.map.

2. У каждой ячейки поля есть размер - он задается при старте очередного раунда игры командой map-info: {{{<map-cell-size><перевод строки><начальное состояние поля на нескольких строках>}}}.

3. Изначально поле заполнено символами '.' (по-видимому, означает пустую клетку), 'w' (уничтожаемая субстанция), или 'X' (неуничтожаемая субстанция).

4. По ходу игры на поле могут появляться и другие предметы:
 * '`*`' - Бомба, поставленная одним из игроков. Взрывается через 40 тиков после постановки.
 * '#' - Взрыв бомбы. Держится 3 тика. Распространяется лучами в четыре стороны на заданное расстояние.
 * Позитивные бонусы:
  * 'b' - consumable substance, that can be processed into annihilator
  * 'v' - consumable substance, that affects engine speed
  * 'f' - consumable substance, that affects annihilator strength
 * Остальные бонусы:
  * 'r' - consumable substance, that temporarly moving controls
  * 's' - consumable substance, that temporarly decrease engine speed
  * 'u' - consumable substance, that temporarly blocks ability to place anihilators
  * 'o' - consumable substance, that temporarly significally decrease anihilator strength
 * '?' - обозначает объект неизвестного типа (в частности, когда игра начинается без включения конфигурационных токенов, то все непустые ячейки поля показываются вопросиками).

Иногда случается коллапс мира (по таймауту?) — поле сжимается по спирали. Сервер об этом сигнализирует с помощью DangerLevel. Во время коллапса лучше держаться ближе к центру поля.

Координаты сапки даны в точках. Одна клетка поля имеет размер несколько точек (сообщается вначале игры). Скорость сапки тоже в точках. Таким образом способность игрока убегать от бомбы сильно зависит от размера клетки — чем больше клетка, тем хуже убегать.

Считается, что все остальные объекты на поле занимают полностью всю свою клетку.

== Команды клиента ==
{{{
Format -->    command ::= [ <move-command> ] [ <action-command> ] ';'
              move-command ::= 'l' | 'r' | 'u' | 'd' | 's'
              action-command ::= 'b'
Where
 l, r, u, d - commands to move left, right, up, and down correspondently.
     s      - command to stop an engine (совершенно непонятно, что это значит).
     b      - command to set up annihilator (кажется, понятия 'annihilator', 'bomb' и 'dangerous substance' эквивалентны).
Examples : r; lb; b; sb;
}}}

== Интересные топики про игру==
  # Можно ли передвигаться по бомбам? — Можно! Сколько угодно.
  # Как ломаются стены взрывами? На всю длину луча или только ближайшая к бомбе стенка? только ближайшая, одновременно с исчезанием огня. Бомбы повышенной (бонусами) мощности ведут себя так же.
  # В сообщении сервера о постановке бомбы указывается время ЧЕРЕЗ которое бомба сдетанирует, или время В которое бомба сдетанирует? - через, и для бомбы и для огня
  # Зависит ли длительность жизни взрыва от его мощности?
  # Где появляется наш бот на карте? В углах? В случайном месте? - в точках, обозначеных в map-файлах буквой o
  # Сколько по времени длится "инфекция" антибонусами? — Примерно 200 тиков.
  # Какие значения dangerLevel считаются большими? Как они связаны с коллапсом мира? — при значении 2 все граничные клетки карты становятся неразрушаемыми, а сапки, стоявшие на этих клетках умирают. Видимо на 3 то же происходит со следующим слоем клеток.
  # Когда примерно по времени наступает коллапс мира? — Через 2700 тиков после начала игры dangerLevel = 2
  # Бомбы детонируют друг от друга. Если в поле действия одного взрыва попала другая бомба, она тоже детонирует одновременно с первой.
  # Бонусы и антибонусы уничтожаются бомбами.
== TODO ==
  # Проверить различные предположения об игре
  # Реализовать поис "безопасных путей" (путей, не пересекающихся во времени и пространстве со взрывами)
  # реализовать жадный алгоритм игры - убегать от опасности и рушить стены
  # Важно! потестить на несимметричных картах на предмет перепутанных координат